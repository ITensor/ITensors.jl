<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>DMRG FAQs · ITensors.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.039/juliamono-regular.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.11/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ITensors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ITensors.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><span class="tocitem">Getting Started with ITensor</span><ul><li><a class="tocitem" href="../getting_started/Installing.html">Installing Julia and ITensor</a></li><li><a class="tocitem" href="../getting_started/RunningCodes.html">Running ITensor and Julia Codes</a></li><li><a class="tocitem" href="../getting_started/DebugChecks.html">Enabling Debug Checks</a></li><li><a class="tocitem" href="../getting_started/NextSteps.html">Next Steps</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/DMRG.html">DMRG</a></li><li><a class="tocitem" href="../tutorials/QN_DMRG.html">Quantum Number Conserving DMRG</a></li><li><a class="tocitem" href="../tutorials/MPSTimeEvolution.html">MPS Time Evolution</a></li></ul></li><li><span class="tocitem">Code Examples</span><ul><li><a class="tocitem" href="../examples/ITensor.html">ITensor Examples</a></li><li><a class="tocitem" href="../examples/MPSandMPO.html">MPS and MPO Examples</a></li><li><a class="tocitem" href="../examples/DMRG.html">DMRG Examples</a></li><li><a class="tocitem" href="../examples/Physics.html">Physics (SiteType) System Examples</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../IndexType.html">Index</a></li><li><a class="tocitem" href="../IndexSetType.html">Index collections</a></li><li><a class="tocitem" href="../ITensorType.html">ITensor</a></li><li><a class="tocitem" href="../MPSandMPO.html">MPS and MPO</a></li><li><a class="tocitem" href="../QN.html">QN</a></li><li><a class="tocitem" href="../SiteType.html">SiteType and op, state, val functions</a></li><li><a class="tocitem" href="../IncludedSiteTypes.html">SiteTypes Included with ITensor</a></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">DMRG</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DMRG.html">DMRG</a></li><li><a class="tocitem" href="../Sweeps.html">Sweeps</a></li><li><a class="tocitem" href="../ProjMPO.html">ProjMPO</a></li><li><a class="tocitem" href="../ProjMPOSum.html">ProjMPOSum</a></li><li><a class="tocitem" href="../Observer.html">Observer System for DMRG</a></li><li><a class="tocitem" href="../DMRGObserver.html">DMRGObserver</a></li></ul></li><li><a class="tocitem" href="../OpSum.html">OpSum (AutoMPO)</a></li></ul></li><li><span class="tocitem">Frequently Asked Questions</span><ul><li><a class="tocitem" href="JuliaAndCpp.html">Programming Language (Julia, C++, ...) FAQs</a></li><li class="is-active"><a class="tocitem" href="DMRG.html">DMRG FAQs</a><ul class="internal"><li><a class="tocitem" href="#Ensuring-a-DMRG-calculation-is-converged"><span>Ensuring a DMRG calculation is converged</span></a></li><li><a class="tocitem" href="#Preventing-DMRG-from-getting-stuck-in-a-local-minimum"><span>Preventing DMRG from getting stuck in a local minimum</span></a></li><li><a class="tocitem" href="#How-to-do-periodic-boundary-condition-DMRG"><span>How to do periodic boundary condition DMRG</span></a></li><li><a class="tocitem" href="#What-boundary-conditions-should-I-choose:-open,-periodic,-or-infinite?"><span>What boundary conditions should I choose: open, periodic, or infinite?</span></a></li></ul></li><li><a class="tocitem" href="Development.html">ITensor Development FAQs</a></li><li><a class="tocitem" href="RelationshipToOtherLibraries.html">Relationship of ITensor to other tensor libraries FAQs</a></li><li><a class="tocitem" href="JuliaPkg.html">Julia Package Manager FAQs</a></li></ul></li><li><span class="tocitem">Upgrade guides</span><ul><li><a class="tocitem" href="../UpgradeGuide_0.1_to_0.2.html">Upgrading from 0.1 to 0.2</a></li></ul></li><li><a class="tocitem" href="../Einsum.html">ITensor indices and Einstein notation</a></li><li><span class="tocitem">Advanced usage guide</span><ul><li><a class="tocitem" href="../AdvancedUsageGuide.html">Advanced usage guide</a></li><li><a class="tocitem" href="../Multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../QNTricks.html">Symmetric (QN conserving) tensors: background and usage</a></li><li><a class="tocitem" href="../CodeTiming.html">Timing and profiling</a></li><li><a class="tocitem" href="../ContractionSequenceOptimization.html">Contraction sequence optimization</a></li><li><a class="tocitem" href="../HDF5FileFormats.html">HDF5 File Formats</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Frequently Asked Questions</a></li><li class="is-active"><a href="DMRG.html">DMRG FAQs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="DMRG.html">DMRG FAQs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ITensor/ITensors.jl/blob/master/docs/src/faq/DMRG.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Density-Matrix-Renormalization-Group-(DMRG)-Frequently-Asked-Questions"><a class="docs-heading-anchor" href="#Density-Matrix-Renormalization-Group-(DMRG)-Frequently-Asked-Questions">Density Matrix Renormalization Group (DMRG) Frequently Asked Questions</a><a id="Density-Matrix-Renormalization-Group-(DMRG)-Frequently-Asked-Questions-1"></a><a class="docs-heading-anchor-permalink" href="#Density-Matrix-Renormalization-Group-(DMRG)-Frequently-Asked-Questions" title="Permalink"></a></h1><h2 id="Ensuring-a-DMRG-calculation-is-converged"><a class="docs-heading-anchor" href="#Ensuring-a-DMRG-calculation-is-converged">Ensuring a DMRG calculation is converged</a><a id="Ensuring-a-DMRG-calculation-is-converged-1"></a><a class="docs-heading-anchor-permalink" href="#Ensuring-a-DMRG-calculation-is-converged" title="Permalink"></a></h2><p>While DMRG calculations can be extremely quick to converge in the best cases, convergence can be slower for cases such as gapless systems or quasi-two-dimensional systems. So it becomes important to know if a DMRG calculation is converged i.e. has been run long enough with enough resources (large enough MPS bond dimension).</p><p>Unfortunately <strong>there is no automatic or bulletproof check for DMRG convergence</strong>. However, there are a number of reliable heuristics you can use to check convergence. We list some of these with the most fundamental and important ones first:</p><ul><li><p>Run your DMRG calculation on a <strong>smaller system</strong> and compare with another method, such as an exact diagonalization. If the agreement is good, then gradually try larger systems and see if the physical properties are roughly consistent and similar (i.e. the density profile has similar features).</p></li><li><p>Make sure to check a <strong>wide range of properties</strong> - not just the energy. See if these look plausible by plotting and visually inspecting them. For example: if your system has  left-right reflection symmetry, does the density or magnetization also have this symmetry?  If the ground  state of your system is expected to have a total <span>$S^z$</span> of zero, does your  ground state have this property?</p></li><li><p>Make sure to run your DMRG calculation for <strong>different numbers of sweeps</strong> to see if  the results change. For example, if you run DMRG for 5 sweeps but are unsure of convergence, try running it for 10 sweeps: is the energy the same or has it significantly decreased? If 10 sweeps made a difference, try 20 sweeps.</p></li><li><p>Inspect the the <strong>DMRG output</strong>.  The ITensor DMRG code reports the maximum bond or link dimension and maximum truncation error after each sweep. (The maximums here mean over each DMRG substep making up one sweep.) Is the maximum dimension or &quot;maxlinkdim&quot; reported by the DMRG output quickly reaching  and saturating the maxdim value you set for each sweep? Is the maximum truncation error  &quot;maxerr&quot; consistently reaching large values, larger than 1E-5?  Then it you may need to raise the maxdim parameter for your later sweeps,  so that DMRG is allowed to use a larger bond dimension and thus reach a better accuracy.</p></li><li><p>Compute the <strong>energy variance</strong> of an MPS to check whether it is an eigenstate. To do this in ITensor, you can use the following code where <code>H</code> is your Hamiltonian MPO and <code>psi</code> is the wavefunction you want to check:</p><pre><code class="language-julia">H2 = inner(H,psi,H,psi)
E = inner(psi&#39;,H,psi)
var = H2-E^2
@show var</code></pre><p>Here <code>var</code> is the quantity <span>$\langle H^2 \rangle - \langle H \rangle^2$</span>. The closer <code>var</code> is to zero, the more precisely <code>psi</code> is an eigenstate of <code>H</code>. Note that this check does not ensure that <code>psi</code> is the ground state, but only one of the  eigenstates.</p></li></ul><h2 id="Preventing-DMRG-from-getting-stuck-in-a-local-minimum"><a class="docs-heading-anchor" href="#Preventing-DMRG-from-getting-stuck-in-a-local-minimum">Preventing DMRG from getting stuck in a local minimum</a><a id="Preventing-DMRG-from-getting-stuck-in-a-local-minimum-1"></a><a class="docs-heading-anchor-permalink" href="#Preventing-DMRG-from-getting-stuck-in-a-local-minimum" title="Permalink"></a></h2><p>While DMRG has very robust convergence properties when the initial MPS is close to the global minimum, if it is far from the global minumum then there is <em>no guarantee</em> that DMRG will be able to find the true ground state. This problem is exacerbated for quantum number conserving DMRG where the search space is more constrained.</p><p>Thus it is very important to perform a number of checks to ensure that the result you get from DMRG is actually converged. To learn about these checks, see the previous question.</p><p>When DMRG is failing to converge, here are some of the steps you can take to improve things:</p><ul><li><p><em>The most important and useful technique</em> is to turn on the <strong>noise term</strong> feature of DMRG. To do this, just set the <code>noise</code> parameter of each sweep to a small, non-zero value, making this value very small (1E-11, say) or zero by the last sweep. (Experiment with different values on small systems to see which noise magnitudes help.) Here is an example of  defining DMRG accuracy or sweep parameters with a non-zero noise set for the first three sweeps:</p><pre><code class="language-julia">nsweeps = 10
maxdim = [100, 200, 400, 800, 1600]
cutoff = [1E-6]
noise = [1E-6, 1E-7, 1E-8, 0.0]
...
energy, psi = dmrg(H,psi0; nsweeps, maxdim, cutoff, noise)</code></pre></li><li><p>Try using a initial MPS with properties close to the ground state you are looking for. For example, the ground state of a system of electrons typically has a density which is spread out over the whole system. So if your initial state has all of the electrons bunched up on the left-hand side only, it can take DMRG a very long time to converge.</p></li><li><p>Try using a random MPS with a modestly large bond dimension. ITensor offers a function called <a href="../MPSandMPO.html#ITensors.randomMPS-Tuple{Vector{&lt;:Index}}"><code>randomMPS</code></a> which can be used to make random MPS in both the quantum number (QN) conserving and non-QN conserving cases. Because random MPS have properties which are &quot;typical&quot; of most ground states, they can be good initial states for DMRG.</p></li><li><p>Try DMRG on a closely related Hamiltonian for which convergence is easier to obtain (be creative here: it could be your Hamiltonian with interactions turned off, or  with interactions only within, but not between, small local patches). Take the output of this first calculation and use it as input for DMRG with the full Hamiltonian.</p></li><li><p>In stubborn cases, try other methods for finding the ground state which are slower, but have a better chance of succeeding. A key example is imaginary time evolution, which  always reaches the ground state if (a) performed accurately on (b) a state which is  not orthogonal to the ground state. After doing some amount of imaginary time evolution, use the resulting MPS as an initial state for DMRG obtain a higher-accuracy solution.</p></li></ul><h2 id="How-to-do-periodic-boundary-condition-DMRG"><a class="docs-heading-anchor" href="#How-to-do-periodic-boundary-condition-DMRG">How to do periodic boundary condition DMRG</a><a id="How-to-do-periodic-boundary-condition-DMRG-1"></a><a class="docs-heading-anchor-permalink" href="#How-to-do-periodic-boundary-condition-DMRG" title="Permalink"></a></h2><p>The short answer to how to do fully periodic boundary condition DMRG in ITensor is that you simply input a <strong>periodic Hamiltonian</strong> into our OpSum system and make the MPO form of your Hamiltonian in the usual way. For example, for a chain of N sites with nearest-neighbor interactions, you include a term that connects site 1 to site N. For a one-dimensional Ising model  chain Hamiltonian this would look like:</p><pre><code class="nohighlight">sites = siteinds(&quot;S=1/2&quot;,N)

hterms = OpSum()
for j=1:(N-1)
  hterms += &quot;Sz&quot;,j,&quot;Sz&quot;,j+1
end
hterms += &quot;Sz&quot;,1,&quot;Sz&quot;,N  # term &#39;wrapping&#39; around the ring

H = MPO(hterms,sites)</code></pre><p>For two-dimensional DMRG calculations, where the most common approach is to use  periodic boundary conditions in the y-direction only, and not in the x-direction,  you do a similar step in making your OpSum input to ITensor DMRG: you include  terms wrapping around the periodic cylinder in the y direction but not in the x direction.</p><p>However, fully periodic boundary conditions are only recommended for small systems  when absolutely needed, and in general are not recommended. For a longer discussion  of alternatives to using fully periodic boundaries, see the next section below.</p><p>The reason fully periodic boundary conditions (periodic in x in 1D, and periodic in both x  and y in 2D) are not recommended in general is that the DMRG algorithm, as we are defining it here, optimizes an <strong>open-boundary MPS</strong>. So if you input a periodic-boundary Hamiltonian, there is a kind of &quot;mismatch&quot; that happens where you can still get the correct answer, but it  requires much more resources (a larger bond dimension and more sweeps) to get good  accuracy. There has been some research into &quot;truly&quot; periodic DMRG, <sup class="footnote-reference"><a id="citeref-Pippan" href="#footnote-Pippan">[Pippan]</a></sup> that is DMRG that optimizes an MPS with a ring-like topology, but it is not widely used, is still an open area of algorithm development, and is not currently available in ITensor.</p><h2 id="What-boundary-conditions-should-I-choose:-open,-periodic,-or-infinite?"><a class="docs-heading-anchor" href="#What-boundary-conditions-should-I-choose:-open,-periodic,-or-infinite?">What boundary conditions should I choose: open, periodic, or infinite?</a><a id="What-boundary-conditions-should-I-choose:-open,-periodic,-or-infinite?-1"></a><a class="docs-heading-anchor-permalink" href="#What-boundary-conditions-should-I-choose:-open,-periodic,-or-infinite?" title="Permalink"></a></h2><p>One of the weaknesses of the density matrix renormalization group (DMRG), and its time-dependent or finite-temperature extensions, is that it works poorly with periodic boundary conditions. This stems from the fact that conventional DMRG optimizes over open-boundary matrix product state (MPS) wavefunctions whether or not the Hamiltonian includes periodic interactions.</p><p>But this begs the question, when are periodic boundary conditions (PBC) really needed? DMRG offers some compelling alternatives to PBC:</p><ul><li><p>Use open boundary conditions (OBC). Though this introduces edge effects, the number of states needed to reach a given accuracy is <em>significantly</em> lower than with PBC (see next section below).  For gapped systems DMRG scales linearly with system size, meaning often one can study systems with many hundreds or even thousands of sites. Last but not least, open boundaries are often more natural. For studying systems which spontaneously break symmetry, adding &quot;pinning&quot; fields on the edge is often a very nice way to tip the balance toward a certain symmetry broken state while leaving the bulk unmodified.</p></li><li><p>Use smooth boundary conditions. The basic idea is to use OBC but  send the Hamiltonian parameters smoothly to zero at the boundary so that the system can not &quot;feel&quot; the boundary. For certain systems this can significantly reduce edge effects.<sup class="footnote-reference"><a id="citeref-Smooth1" href="#footnote-Smooth1">[Smooth1]</a></sup><sup class="footnote-reference"><a id="citeref-Smooth2" href="#footnote-Smooth2">[Smooth2]</a></sup><sup class="footnote-reference"><a id="citeref-Smooth3" href="#footnote-Smooth3">[Smooth3]</a></sup></p></li></ul><ul><li>Use &quot;infinite boundary conditions&quot;, that is, use infinite DMRG in the form of an algorithm like iDMRG or VUMPS. This has a cost that can be even less than with OBC yet is completely free of finite-size effects.</li></ul><p>However, there are a handful of cases where PBC remains preferable despite the extra overhead. A few such cases are:</p><ul><li><p>Benchmarking DMRG against another code that uses PBC, such as a Monte Carlo or exact diagonalization code.</p></li><li><p>Extracting the central charge of a critical one-dimensional system described by a CFT. In practice, using PBC can give an accurate central charge even for quite small systems by fitting the subsystem entanglement entropy to the CFT scaling form.</p></li><li><p>Checking for the presence or absence of topological effects. These could be edge effects (the Haldane phase has a four-fold ground state degeneracy with OBC, but not with PBC), or could be related to some global topological sector that is ill-defined with PBC (e.g. periodic vs. antiperiodic boundary conditions for the transverse field Ising model).</p></li></ul><p>(Note that in the remaining discussion, by PBC I mean  <em>fully periodic</em> boundary conditions in all directions. For the case of DMRG applied to quasi-two-dimensional systems, it remains a good practice to use periodic boundaries in the shorter direction, while still using open (or infinite) boundaries in the longer direction along the DMRG/MPS path.)</p><p>Below I discuss more about the problems with using PBC, as well as some misconceptions about when PBC seems necessary even though there are better alternatives.</p><h4 id="Drawbacks-of-Periodic-Boundary-Conditions"><a class="docs-heading-anchor" href="#Drawbacks-of-Periodic-Boundary-Conditions">Drawbacks of Periodic Boundary Conditions</a><a id="Drawbacks-of-Periodic-Boundary-Conditions-1"></a><a class="docs-heading-anchor-permalink" href="#Drawbacks-of-Periodic-Boundary-Conditions" title="Permalink"></a></h4><p>Periodic boundary conditions are straightforward to implement in conventional DMRG. The simplest approach is to include a &quot;long bond&quot; directly connecting site 1 to site N in the Hamiltonian. However this  naive approach has a major drawback: if open-boundary DMRG achieves a given accuracy when keeping <span>$m$</span> states (bond dimension of size <span>$m$</span>), then to reach the same accuracy with PBC one must keep closer to <span>$m^2$</span> states! The reason is that now every bond of the MPS not only carries local entanglement as with OBC, but also the entanglement between the first and last sites. (There is an alternative DMRG algorithm<sup class="footnote-reference"><a id="citeref-Pippan" href="#footnote-Pippan">[Pippan]</a></sup> for periodic systems which may have better scaling than the above approach but has not been widely applied and tested, as far as I am aware, especially for  2D or critical systems .)</p><p>The change in scaling from <span>$m$</span> to <span>$m^2$</span>  is a severe problem. For example, many gapped one-dimensional systems only require about <span>$m=100$</span> to reach good accuracy (truncation errors of less than 1E-9 or so). To reach the same accuracy with naive PBC would then require using 10,000 states, which can easily fill the RAM of a typical desktop computer for a large enough system, not to mention the extra time needed to work with larger matrices.</p><p>But poor scaling is not the only drawback of PBC. Systems that exhibit spontaneous symmetry breaking  are simple to work with under OBC, where one has the additional freedom of applying edge pinning terms  to drive the bulk into a specific symmetry sector. Using edge pinning reduces the bulk entanglement and makes measuring order parameters straightforward. Similarly one can use infinite DMRG to directly observe symmetry breaking effects.</p><p>But under PBC, order parameters remain equal to zero and can only be accessed through correlation functions. Though using correlation functions is often presented as the &quot;standard&quot; or &quot;correct&quot; approach, such reasoning pre-supposes that PBC is the best choice. Recent work in the quantum Monte Carlo community demonstrates that open boundaries with pinning fields can actually be a superior approach.<sup class="footnote-reference"><a id="citeref-Assaad" href="#footnote-Assaad">[Assaad]</a></sup></p><h4 id="Cases-Where-Periodic-BC-Seems-Necessary,-But-Open/Infinite-BC-Can-be-Better"><a class="docs-heading-anchor" href="#Cases-Where-Periodic-BC-Seems-Necessary,-But-Open/Infinite-BC-Can-be-Better">Cases Where Periodic BC Seems Necessary, But Open/Infinite BC Can be Better</a><a id="Cases-Where-Periodic-BC-Seems-Necessary,-But-Open/Infinite-BC-Can-be-Better-1"></a><a class="docs-heading-anchor-permalink" href="#Cases-Where-Periodic-BC-Seems-Necessary,-But-Open/Infinite-BC-Can-be-Better" title="Permalink"></a></h4><p>Below are some cases where periodic boundary conditions seem to be necessary at a first glance.  But in many of these cases, not only can open or infinite boundaries be just as successful, they  can even be the better choice.</p><ul><li><em>Measuring asymptotic properties of correlation functions</em>: much of our understanding of gapless one-dimensional systems comes from field-theoretic approaches which make specific predictions about asymptotic decays of various correlators. To test these predictions numerically, one must  work with large, translationally invariant systems with minimal edge effects. Using fully periodic boundary conditions satisfies these criteria. However, a superior choice is to use infinite DMRG, which combines the much better scaling of open-boundary DMRG with the ability to  measure correlators at <em>arbitrarily long</em> distances by repeating the unit cell of the MPS wavefunction. Although truncating to a finite number of states imposes an effective correlation length on the system, this correlation length can reach many thousands of sites for quite moderate MPS bond dimensions. Karrasch and Moore took advantage of this fact to convincingly check the predictions of Luttinger liquid theory for one-dimensional systems of gapless fermions.<sup class="footnote-reference"><a id="citeref-Karrasch" href="#footnote-Karrasch">[Karrasch]</a></sup></li></ul><ul><li><em>Studying two-dimensional topological order</em>: a hallmark of intrinsic topological order is the presence of a robust ground state degeneracy when the system is put on a torus. Also many topological phases  have gapless edge states which can cause problems for numerical calculations. Thus one might think that fully periodic BC are the best choice for studying topological phases. However,  topological phases have the same ground-state degeneracy on an infinite cylinder as they do on a torus.<sup class="footnote-reference"><a id="citeref-Zhang" href="#footnote-Zhang">[Zhang]</a></sup>. Cincio and Vidal exploited this fact to use infinite DMRG to study a variety of topological phases <sup class="footnote-reference"><a id="citeref-Cincio" href="#footnote-Cincio">[Cincio]</a></sup>. One part of their calculation did actually require obtaining ground states on a torus, but they accomplished this by taking a finite segment of an infinite MPS  and connecting its ends. This approach does not give the true ground state of the torus but was sufficient  for their calculation and was arguably closer to the true two-dimensional physics.</li></ul><ul><li><p><em>Obtaining bulk gaps</em>:  DMRG has the ability to &quot;target&quot; low-lying excited states or to obtain such states by constraining them to be orthogonal to the ground state. However, with OBC,  localized excitations can get stuck to the edges and not reveal the true bulk gap behavior.  Thus one may conclude that PBC is necessary. But using open or infinite boundaries remains  the better choice because they allow much higher accuracy.</p><p>To deal with the presence of edges in OBC, one can use &quot;restricted sweeping&quot;. Here one sweeps across the full system to obtain the ground state. Then, to obtain the first excited state one only sweeps through the full system to obtain the ground state. Then, to obtain the first excited state one only sweeps through the near the edges. This traps the particle in a &quot;soft box&quot; which still lets its wavefunction mix with the basis that describes the ground state outside the restricted sweeping region.</p><p>Within infinite DMRG, boundary effects are rigorously absent if the calculation has converged. To compute bulk gaps one again uses a type of restricted sweeping known in the literature as &quot;infinite boundary conditions&quot;. For more see the work by Phien, Vidal, and McCulloch.<sup class="footnote-reference"><a id="citeref-Phien" href="#footnote-Phien">[Phien]</a></sup></p></li></ul><p>In conclusion, consider carefully whether you really need to use periodic boundary conditions, as they impose a steep computational cost within DMRG. Periodic BC can actually be worse for the very types of measurements where they are  often presented as the best or &quot;standard&quot; choice. Many of the issues periodic boundaries circumvent can be avoided more elegantly by using infinite DMRG, or when that is not applicable, by using open boundary conditions with sufficient care.</p><section class="footnotes is-size-7"><ul><li class="footnote" id="footnote-Smooth1"><a class="tag is-link" href="#citeref-Smooth1">Smooth1</a><a href="http://dx.doi.org/10.1103/PhysRevLett.71.4283">Smooth boundary conditions for quantum lattice systems</a>, M. Vekic and Steven R. White, <em>Phys. Rev. Lett.</em> <strong>71</strong>, <a href="http://dx.doi.org/10.1103/PhysRevLett.71.4283">4283</a> (1993) cond-mat/<a href="http://arxiv.org/abs/cond-mat/9310053">9310053</a></li><li class="footnote" id="footnote-Smooth2"><a class="tag is-link" href="#citeref-Smooth2">Smooth2</a><a href="http://dx.doi.org/10.1103/PhysRevB.53.14552">Hubbard model with smooth boundary conditions</a>, M. Vekic and Steven R. White, <em>Phys. Rev. B</em> <strong>53</strong>, <a href="http://dx.doi.org/10.1103/PhysRevB.53.14552">14552</a> (1996) cond-mat/<a href="http://arxiv.org/abs/cond-mat/9601009">9601009</a></li><li class="footnote" id="footnote-Smooth3"><a class="tag is-link" href="#citeref-Smooth3">Smooth3</a><a href="http://link.aps.org/doi/10.1103/PhysRevB.86.041108">Grand canonical finite-size numerical approaches: A route to measuring bulk properties in an applied field</a>, Chisa Hotta and Naokazu Shibata, <em>Phys. Rev. B</em> <strong>86</strong>, <a href="http://link.aps.org/doi/10.1103/PhysRevB.86.041108">041108</a> (2012) </li><li class="footnote" id="footnote-Pippan"><a class="tag is-link" href="#citeref-Pippan">Pippan</a><a href="http://link.aps.org/doi/10.1103/PhysRevB.81.081103">Efficient matrix-product state method for periodic boundary conditions</a>, P. Pippan, Steven R. White, and H.G. Evertz, <em>Phys. Rev. B</em> <strong>81</strong>, <a href="http://link.aps.org/doi/10.1103/PhysRevB.81.081103">081103</a></li><li class="footnote" id="footnote-Assaad"><a class="tag is-link" href="#citeref-Assaad">Assaad</a><a href="http://dx.doi.org/10.1103/PhysRevX.3.031010">Pinning the Order: The Nature of Quantum Criticality in the Hubbard Model on Honeycomb Lattice</a>, Fakher F. Assaad and Igor F. Herbut, <em>Phys. Rev. X</em> <strong>3</strong>, <a href="http://dx.doi.org/10.1103/PhysRevX.3.031010">031010</a></li><li class="footnote" id="footnote-Karrasch"><a class="tag is-link" href="#citeref-Karrasch">Karrasch</a><a href="http://dx.doi.org/10.1103/PhysRevB.86.155156">Luttinger liquid physics from the infinite-system density matrix renormalization group</a>, C. Karrasch and J.E. Moore, <em>Phys. Rev. B</em> <strong>86</strong>, <a href="http://dx.doi.org/10.1103/PhysRevB.86.155156">155156</a></li><li class="footnote" id="footnote-Zhang"><a class="tag is-link" href="#citeref-Zhang">Zhang</a><a href="http://dx.doi.org/10.1103/PhysRevB.85.235151">Quasiparticle statistics and braiding from ground-state entanglement</a>, Yi Zhang, Tarun Grover, Ari Turner, Masaki Oshkawa, and Ashvin Vishwanath, <em>Phys. Rev. B</em> <strong>85</strong>, <a href="http://dx.doi.org/10.1103/PhysRevB.85.235151">235151</a></li><li class="footnote" id="footnote-Cincio"><a class="tag is-link" href="#citeref-Cincio">Cincio</a><a href="http://link.aps.org/doi/10.1103/PhysRevLett.110.067208">Characterizing Topological Order by Studying the Ground States on an Infinite Cylinder</a>, L. Cincio and G. Vidal, <em>Phys. Rev. Lett.</em> <strong>110</strong>, <a href="http://link.aps.org/doi/10.1103/PhysRevLett.110.067208">067208</a></li><li class="footnote" id="footnote-Phien"><a class="tag is-link" href="#citeref-Phien">Phien</a><a href="http://link.aps.org/doi/10.1103/PhysRevB.86.245107">Infinite boundary conditions for matrix product state calculations</a>, Ho N. Phien, G. Vidal, and Ian P. McCulloch <em>Phys. Rev. B</em> <strong>86</strong>, <a href="http://link.aps.org/doi/10.1103/PhysRevB.86.245107">245107</a></li></ul></section></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="JuliaAndCpp.html">« Programming Language (Julia, C++, ...) FAQs</a><a class="docs-footer-nextpage" href="Development.html">ITensor Development FAQs »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.3 on <span class="colophon-date" title="Sunday 11 September 2022 02:51">Sunday 11 September 2022</span>. Using Julia version 1.8.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
