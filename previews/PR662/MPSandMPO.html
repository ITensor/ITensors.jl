<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>MPS and MPO · ITensors.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link href="assets/favicon.ico" rel="icon" type="image/x-icon"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="index.html"><img src="assets/logo.png" alt="ITensors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit">ITensors.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Introduction</a></li><li><span class="tocitem">Getting Started with ITensor</span><ul><li><a class="tocitem" href="getting_started/Installing.html">Installing Julia and ITensor</a></li><li><a class="tocitem" href="getting_started/RunningCodes.html">Running ITensor and Julia Codes</a></li><li><a class="tocitem" href="getting_started/Tutorials.html">Tutorials</a></li><li><a class="tocitem" href="getting_started/NextSteps.html">Next Steps</a></li></ul></li><li><span class="tocitem">Code Examples</span><ul><li><a class="tocitem" href="examples/ITensor.html">ITensor Examples</a></li><li><a class="tocitem" href="examples/MPSandMPO.html">MPS and MPO Examples</a></li><li><a class="tocitem" href="examples/DMRG.html">DMRG Examples</a></li><li><a class="tocitem" href="examples/Physics.html">Physics System Examples</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="IndexType.html">Index</a></li><li><a class="tocitem" href="IndexValType.html">IndexVal</a></li><li><a class="tocitem" href="IndexSetType.html">IndexSet</a></li><li><a class="tocitem" href="ITensorType.html">ITensor</a></li><li class="is-active"><a class="tocitem" href="MPSandMPO.html">MPS and MPO</a><ul class="internal"><li><a class="tocitem" href="#Types-1"><span>Types</span></a></li><li><a class="tocitem" href="#MPS-Constructors-1"><span>MPS Constructors</span></a></li><li><a class="tocitem" href="#MPO-Constructors-1"><span>MPO Constructors</span></a></li><li><a class="tocitem" href="#Properties-1"><span>Properties</span></a></li><li><a class="tocitem" href="#Obtaining-and-finding-indices-1"><span>Obtaining and finding indices</span></a></li><li><a class="tocitem" href="#Priming-and-tagging-1"><span>Priming and tagging</span></a></li><li><a class="tocitem" href="#Operations-1"><span>Operations</span></a></li><li><a class="tocitem" href="#Gate-evolution-1"><span>Gate evolution</span></a></li><li><a class="tocitem" href="#Algebra-Operations-1"><span>Algebra Operations</span></a></li></ul></li><li><a class="tocitem" href="QN.html">QN</a></li><li><a class="tocitem" href="SiteType.html">SiteType and op</a></li><li><input class="collapse-toggle" id="menuitem-4-8" type="checkbox"/><label class="tocitem" for="menuitem-4-8"><span class="docs-label">DMRG</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="DMRG.html">DMRG</a></li><li><a class="tocitem" href="Sweeps.html">Sweeps</a></li><li><a class="tocitem" href="ProjMPO.html">ProjMPO</a></li><li><a class="tocitem" href="ProjMPOSum.html">ProjMPOSum</a></li><li><a class="tocitem" href="Observer.html">Observer System for DMRG</a></li><li><a class="tocitem" href="DMRGObserver.html">DMRGObserver</a></li></ul></li><li><a class="tocitem" href="AutoMPO.html">AutoMPO</a></li></ul></li><li><span class="tocitem">Advanced usage guide</span><ul><li><a class="tocitem" href="AdvancedUsageGuide.html">Advanced usage guide</a></li><li><a class="tocitem" href="Multithreading.html">Multithreading</a></li><li><a class="tocitem" href="QNTricks.html">Symmetric tensor background and usage</a></li><li><a class="tocitem" href="CodeTiming.html">Timing and profiling</a></li><li><a class="tocitem" href="ContractionSequenceOptimization.html">Contraction sequence optimization</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Documentation</a></li><li class="is-active"><a href="MPSandMPO.html">MPS and MPO</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="MPSandMPO.html">MPS and MPO</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ITensor/ITensors.jl/blob/master/docs/src/MPSandMPO.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="MPS-and-MPO-1"><a class="docs-heading-anchor" href="#MPS-and-MPO-1">MPS and MPO</a><a class="docs-heading-anchor-permalink" href="#MPS-and-MPO-1" title="Permalink"></a></h1><h2 id="Types-1"><a class="docs-heading-anchor" href="#Types-1">Types</a><a class="docs-heading-anchor-permalink" href="#Types-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPS" href="#ITensors.MPS"><code>ITensors.MPS</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MPS</code></pre><p>A finite size matrix product state type. Keeps track of the orthogonality center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L2-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPO" href="#ITensors.MPO"><code>ITensors.MPO</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MPO</code></pre><p>A finite size matrix product operator type.  Keeps track of the orthogonality center.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L2-L7">source</a></section></article><h2 id="MPS-Constructors-1"><a class="docs-heading-anchor" href="#MPS-Constructors-1">MPS Constructors</a><a class="docs-heading-anchor-permalink" href="#MPS-Constructors-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPS-Tuple{Int64}" href="#ITensors.MPS-Tuple{Int64}"><code>ITensors.MPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS(N::Int)</code></pre><p>Construct an MPS with N sites with default constructed ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L31-L36">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index}" href="#ITensors.MPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index}"><code>ITensors.MPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS([::Type{ElT} = Float64, ]sites; linkdims=1)</code></pre><p>Construct an MPS filled with Empty ITensors of type <code>ElT</code> from a collection of indices.</p><p>Optionally specify the link dimension with the keyword argument <code>linkdims</code>, which by default is 1.</p><p>In the future we may generalize <code>linkdims</code> to allow specifying each individual link dimension as a vector, and additionally allow specifying quantum numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L41-L50">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.randomMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index}" href="#ITensors.randomMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index}"><code>ITensors.randomMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">randomMPS(sites::Vector{&lt;:Index}, linkdim=1)</code></pre><p>Construct a random MPS with link dimension <code>linkdim</code> of  type <code>Float64</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L194-L199">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.randomMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index}" href="#ITensors.randomMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index}"><code>ITensors.randomMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">randomMPS(::Type{ElT&lt;:Number}, sites::Vector{&lt;:Index}, linkdim=1)</code></pre><p>Construct a random MPS with link dimension <code>linkdim</code> of  type <code>ElT</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L178-L183">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.randomMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index, Any, Int64}" href="#ITensors.randomMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index, Any, Int64}"><code>ITensors.randomMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">randomMPS(sites::Vector{&lt;:Index}, state, linkdim=1)</code></pre><p>Construct a real, random MPS with link dimension <code>linkdim</code>, made by randomizing an initial product state specified by <code>state</code>. This version of <code>randomMPS</code> is necessary when creating QN-conserving random MPS (consisting of QNITensors). The initial <code>state</code> array provided determines the total QN of the resulting random MPS.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L215-L224">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.productMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index, Any}" href="#ITensors.productMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Index, Any}"><code>ITensors.productMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS(sites::Vector{&lt;:Index},states)
productMPS(sites::Vector{&lt;:Index},states)</code></pre><p>Construct a product state MPS having site indices <code>sites</code>, and which corresponds to the initial state given by the array <code>states</code>. The <code>states</code> array may consist of either an array of integers or strings, as  recognized by the <code>state</code> function defined for the relevant Index tag type.</p><p><strong>Examples</strong></p><pre><code class="language-julia">N = 10
sites = siteinds(&quot;S=1/2&quot;,N)
states = [isodd(n) ? &quot;Up&quot; : &quot;Dn&quot; for n=1:N]
psi = MPS(sites,states)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L317-L335">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.productMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, Any}" href="#ITensors.productMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, Any}"><code>ITensors.productMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS(::Type{T},
    sites::Vector{&lt;:Index},
    states::Union{Vector{String},
                  Vector{Int},
                  String,
                  Int})</code></pre><p>Construct a product state MPS of element type <code>T</code>, having site indices <code>sites</code>, and which corresponds to the initial state given by the array <code>states</code>. The input <code>states</code> may be an array of strings or an array of ints recognized by the  <code>state</code> function defined for the relevant Index tag type. In addition, a single string or int can be input to create a uniform state.</p><p><strong>Examples</strong></p><pre><code class="language-julia">N = 10
sites = siteinds(&quot;S=1/2&quot;, N)
states = [isodd(n) ? &quot;Up&quot; : &quot;Dn&quot; for n=1:N]
psi = MPS(ComplexF64, sites, states)
phi = MPS(sites, &quot;Up&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L272-L296">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.productMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:IndexVal}" href="#ITensors.productMPS-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:IndexVal}"><code>ITensors.productMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS(ivals::Vector{&lt;:IndexVal})
productMPS(ivals::Vector{&lt;:IndexVal})</code></pre><p>Construct a product state MPS with element type <code>Float64</code> and nonzero values determined from the input IndexVals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L263-L269">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.productMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:IndexVal}" href="#ITensors.productMPS-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:IndexVal}"><code>ITensors.productMPS</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPS(::Type{T&lt;:Number}, ivals::Vector{&lt;:IndexVal})
productMPS(::Type{T&lt;:Number}, ivals::Vector{&lt;:IndexVal})</code></pre><p>Construct a product state MPS with element type <code>T</code> and nonzero values determined from the input IndexVals.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L226-L232">source</a></section></article><h2 id="MPO-Constructors-1"><a class="docs-heading-anchor" href="#MPO-Constructors-1">MPO Constructors</a><a class="docs-heading-anchor-permalink" href="#MPO-Constructors-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPO-Tuple{Int64}" href="#ITensors.MPO-Tuple{Int64}"><code>ITensors.MPO</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPO(N::Int)</code></pre><p>Make an MPO of length <code>N</code> filled with default ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L54-L58">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPO-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, Vector{String}}" href="#ITensors.MPO-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, Vector{String}}"><code>ITensors.MPO</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPO([::Type{ElT} = Float64}, ]sites, ops::Vector{String})</code></pre><p>Make an MPO with pairs of sites <code>s[i]</code> and <code>s[i]&#39;</code> and operators <code>ops</code> on each site.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L61-L66">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPO-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, String}" href="#ITensors.MPO-Tuple{Type{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:Number, Vector{var&quot;#s57&quot;} where var&quot;#s57&quot;&lt;:Index, String}"><code>ITensors.MPO</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPO([::Type{ElT} = Float64, ]sites, op::String)</code></pre><p>Make an MPO with pairs of sites <code>s[i]</code> and <code>s[i]&#39;</code> and operator <code>op</code> on every site.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L90-L95">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.MPO-Tuple{MPS}" href="#ITensors.MPO-Tuple{MPS}"><code>ITensors.MPO</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">MPO(A::MPS; kwargs...)</code></pre><p>For an MPS <code>|A&gt;</code>, make the MPO <code>|A&gt;&lt;A|</code>. Keyword arguments like <code>cutoff</code> can be used to truncate the resulting MPO.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L118-L124">source</a></section></article><h2 id="Properties-1"><a class="docs-heading-anchor" href="#Properties-1">Properties</a><a class="docs-heading-anchor-permalink" href="#Properties-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="Base.eltype-Tuple{ITensors.AbstractMPS}" href="#Base.eltype-Tuple{ITensors.AbstractMPS}"><code>Base.eltype</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">eltype(m::MPS)
eltype(m::MPO)</code></pre><p>Return the common element type of the tensors in the MPS or MPO. For example, if all tensors have type Float64 then return Float64. But if one or more tensors have type ComplexF64, return ComplexF64.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L19-L28">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.flux-Tuple{ITensors.AbstractMPS}" href="#ITensors.flux-Tuple{ITensors.AbstractMPS}"><code>ITensors.flux</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">flux(M::MPS)

flux(M::MPO)

totalqn(M::MPS)

totalqn(M::MPO)</code></pre><p>For an MPS or MPO which conserves quantum numbers, compute the total QN flux. For a tensor network such as an MPS or MPO, the flux is the sum of fluxes of each of the tensors in the network. The name <code>totalqn</code> is an alias for <code>flux</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1753-L1768">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.hasqns-Tuple{ITensors.AbstractMPS}" href="#ITensors.hasqns-Tuple{ITensors.AbstractMPS}"><code>ITensors.hasqns</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">hasqns(M::MPS)

hasqns(M::MPO)</code></pre><p>Return true if the MPS or MPO has tensors which carry quantum numbers.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1739-L1746">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.length-Tuple{ITensors.AbstractMPS}" href="#Base.length-Tuple{ITensors.AbstractMPS}"><code>Base.length</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">length(::MPS/MPO)</code></pre><p>The number of sites of an MPS/MPO.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L3-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.maxlinkdim-Tuple{ITensors.AbstractMPS}" href="#ITensors.maxlinkdim-Tuple{ITensors.AbstractMPS}"><code>ITensors.maxlinkdim</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">maxlinkdim(M::MPS)
maxlinkdim(M::MPO)</code></pre><p>Get the maximum link dimension of the MPS or MPO.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L796-L801">source</a></section></article><h2 id="Obtaining-and-finding-indices-1"><a class="docs-heading-anchor" href="#Obtaining-and-finding-indices-1">Obtaining and finding indices</a><a class="docs-heading-anchor-permalink" href="#Obtaining-and-finding-indices-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteinds-Tuple{typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS, Int64}" href="#ITensors.siteinds-Tuple{typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS, Int64}"><code>ITensors.siteinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteinds(commoninds, A::MPO, B::MPS, j::Integer; kwargs...)
siteinds(commonind, A::MPO, B::MPO, j::Integer; kwargs...)</code></pre><p>Get the site index (or indices) of  the <code>j</code>th MPO tensor of <code>A</code> that is shared with MPS/MPO <code>B</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L352-L357">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteinds-Tuple{typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS, Int64}" href="#ITensors.siteinds-Tuple{typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS, Int64}"><code>ITensors.siteinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteinds(uniqueinds, A::MPO, B::MPS, j::Integer; kwargs...)
siteinds(uniqueind, A::MPO, B::MPS, j::Integer; kwargs...)</code></pre><p>Get the site index (or indices) of MPO <code>A</code> that is unique to <code>A</code> (not shared with MPS/MPO <code>B</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L320-L325">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.findsite" href="#ITensors.findsite"><code>ITensors.findsite</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findsite(M::Union{MPS, MPO}, is)</code></pre><p>Return the first site of the MPS or MPO that has at least one Index in common with the Index or collection of indices <code>is</code>.</p><p>To find all sites with common indices with <code>is</code>, use the  <code>findsites</code> function.</p><p><strong>Examples</strong></p><pre><code class="language-julia">s = siteinds(&quot;S=1/2&quot;, 5)
ψ = randomMPS(s)
findsite(ψ, s[3]) == 3
findsite(ψ, (s[3], s[4])) == 3

M = MPO(s)
findsite(M, s[4]) == 4
findsite(M, s[4]&#39;) == 4
findsite(M, (s[4]&#39;, s[4])) == 4
findsite(M, (s[4]&#39;, s[3])) == 3</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L388-L410">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.findsites" href="#ITensors.findsites"><code>ITensors.findsites</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">findsites(M::Union{MPS, MPO}, is)</code></pre><p>Return the sites of the MPS or MPO that have indices in common with the collection of site indices <code>is</code>.</p><p><strong>Examples</strong></p><pre><code class="language-julia">s = siteinds(&quot;S=1/2&quot;, 5)
ψ = randomMPS(s)
findsites(ψ, s[3]) == [3]
findsites(ψ, (s[4], s[1])) == [1, 4]

M = MPO(s)
findsites(M, s[4]) == [4]
findsites(M, s[4]&#39;) == [4]
findsites(M, (s[4]&#39;, s[4])) == [4]
findsites(M, (s[4]&#39;, s[3])) == [3, 4]</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L421-L441">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.firstsiteinds" href="#ITensors.firstsiteinds"><code>ITensors.firstsiteinds</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">firstsiteinds(M::MPO; kwargs...)</code></pre><p>Get a Vector of the first site Index found on each site of M.</p><p>By default, it finds the first site Index with prime level 0.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L166-L172">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.linkind-Tuple{ITensors.AbstractMPS, Int64}" href="#ITensors.linkind-Tuple{ITensors.AbstractMPS, Int64}"><code>ITensors.linkind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">linkind(M::MPS, j::Integer)
linkind(M::MPO, j::Integer)</code></pre><p>Get the link or bond Index connecting the MPS or MPO tensor on site j to site j+1.</p><p>If there is no link Index, return <code>nothing</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L197-L205">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteind-Tuple{MPS, Int64}" href="#ITensors.siteind-Tuple{MPS, Int64}"><code>ITensors.siteind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteind(M::MPS, j::Int; kwargs...)</code></pre><p>Get the first site Index of the MPS. Return <code>nothing</code> if none is found.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L338-L342">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteind-Tuple{typeof(first), MPS, Int64}" href="#ITensors.siteind-Tuple{typeof(first), MPS, Int64}"><code>ITensors.siteind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteind(::typeof(first), M::Union{MPS,MPO}, j::Integer; kwargs...)</code></pre><p>Return the first site Index found on the MPS or MPO (the first Index unique to the <code>j</code>th MPS/MPO tensor).</p><p>You can choose different filters, like prime level and tags, with the <code>kwargs</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L471-L479">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteinds-Tuple{MPS}" href="#ITensors.siteinds-Tuple{MPS}"><code>ITensors.siteinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteinds(M::MPS)
siteinds(::typeof(first), M::MPS)</code></pre><p>Get a vector of the first site Index found on each tensor of the MPS.</p><pre><code class="language-none">siteinds(::typeof(only), M::MPS)</code></pre><p>Get a vector of the only site Index found on each tensor of the MPS. Errors if more than one is found.</p><pre><code class="language-none">siteinds(::typeof(all), M::MPS)</code></pre><p>Get a vector of the all site Indices found on each tensor of the MPS. Returns a Vector of IndexSets.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L358-L371">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteind-Tuple{MPO, Int64}" href="#ITensors.siteind-Tuple{MPO, Int64}"><code>ITensors.siteind</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteind(M::MPO, j::Int; plev = 0, kwargs...)</code></pre><p>Get the first site Index of the MPO found, by default with prime level 0. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L134-L139">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteinds-Tuple{MPO}" href="#ITensors.siteinds-Tuple{MPO}"><code>ITensors.siteinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteinds(M::MPO; kwargs...)</code></pre><p>Get a Vector of IndexSets of all the site indices of M.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L145-L149">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.siteinds-Tuple{ITensors.AbstractMPS, Int64}" href="#ITensors.siteinds-Tuple{ITensors.AbstractMPS, Int64}"><code>ITensors.siteinds</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">siteinds(M::Union{MPS, MPO}}, j::Integer; kwargs...)</code></pre><p>Return the site Indices found of the MPO or MPO at the site <code>j</code> as an IndexSet.</p><p>Optionally filter prime tags and prime levels with keyword arguments like <code>plev</code> and <code>tags</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L493-L501">source</a></section></article><h2 id="Priming-and-tagging-1"><a class="docs-heading-anchor" href="#Priming-and-tagging-1">Priming and tagging</a><a class="docs-heading-anchor-permalink" href="#Priming-and-tagging-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.prime-Tuple{ITensors.AbstractMPS}" href="#ITensors.prime-Tuple{ITensors.AbstractMPS}"><code>ITensors.prime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prime[!](M::MPS, args...; kwargs...)
prime[!](M::MPO, args...; kwargs...)</code></pre><p>Apply prime to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.prime-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.prime-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.prime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prime[!](siteinds, M::MPS, args...; kwargs...)
prime[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply prime to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.prime-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.prime-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.prime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prime[!](linkinds, M::MPS, args...; kwargs...)
prime[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply prime to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.prime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.prime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.prime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prime[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
prime[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply prime to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.prime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.prime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.prime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">prime[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply prime to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.setprime-Tuple{ITensors.AbstractMPS}" href="#ITensors.setprime-Tuple{ITensors.AbstractMPS}"><code>ITensors.setprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setprime[!](M::MPS, args...; kwargs...)
setprime[!](M::MPO, args...; kwargs...)</code></pre><p>Apply setprime to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.setprime-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.setprime-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.setprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setprime[!](siteinds, M::MPS, args...; kwargs...)
setprime[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply setprime to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.setprime-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.setprime-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.setprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setprime[!](linkinds, M::MPS, args...; kwargs...)
setprime[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply setprime to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.setprime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.setprime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.setprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setprime[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
setprime[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply setprime to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.setprime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.setprime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.setprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">setprime[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply setprime to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.noprime-Tuple{ITensors.AbstractMPS}" href="#ITensors.noprime-Tuple{ITensors.AbstractMPS}"><code>ITensors.noprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">noprime[!](M::MPS, args...; kwargs...)
noprime[!](M::MPO, args...; kwargs...)</code></pre><p>Apply noprime to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.noprime-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.noprime-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.noprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">noprime[!](siteinds, M::MPS, args...; kwargs...)
noprime[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply noprime to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.noprime-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.noprime-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.noprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">noprime[!](linkinds, M::MPS, args...; kwargs...)
noprime[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply noprime to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.noprime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.noprime-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.noprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">noprime[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
noprime[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply noprime to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.noprime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.noprime-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.noprime</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">noprime[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply noprime to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.addtags-Tuple{ITensors.AbstractMPS}" href="#ITensors.addtags-Tuple{ITensors.AbstractMPS}"><code>ITensors.addtags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">addtags[!](M::MPS, args...; kwargs...)
addtags[!](M::MPO, args...; kwargs...)</code></pre><p>Apply addtags to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.addtags-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.addtags-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.addtags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">addtags[!](siteinds, M::MPS, args...; kwargs...)
addtags[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply addtags to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.addtags-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.addtags-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.addtags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">addtags[!](linkinds, M::MPS, args...; kwargs...)
addtags[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply addtags to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.addtags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.addtags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.addtags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">addtags[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
addtags[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply addtags to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.addtags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.addtags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.addtags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">addtags[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply addtags to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.removetags-Tuple{ITensors.AbstractMPS}" href="#ITensors.removetags-Tuple{ITensors.AbstractMPS}"><code>ITensors.removetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">removetags[!](M::MPS, args...; kwargs...)
removetags[!](M::MPO, args...; kwargs...)</code></pre><p>Apply removetags to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.removetags-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.removetags-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.removetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">removetags[!](siteinds, M::MPS, args...; kwargs...)
removetags[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply removetags to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.removetags-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.removetags-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.removetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">removetags[!](linkinds, M::MPS, args...; kwargs...)
removetags[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply removetags to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.removetags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.removetags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.removetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">removetags[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
removetags[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply removetags to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.removetags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.removetags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.removetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">removetags[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply removetags to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacetags-Tuple{ITensors.AbstractMPS}" href="#ITensors.replacetags-Tuple{ITensors.AbstractMPS}"><code>ITensors.replacetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacetags[!](M::MPS, args...; kwargs...)
replacetags[!](M::MPO, args...; kwargs...)</code></pre><p>Apply replacetags to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacetags-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.replacetags-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.replacetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacetags[!](siteinds, M::MPS, args...; kwargs...)
replacetags[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply replacetags to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacetags-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.replacetags-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.replacetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacetags[!](linkinds, M::MPS, args...; kwargs...)
replacetags[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply replacetags to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacetags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.replacetags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.replacetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacetags[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
replacetags[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply replacetags to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacetags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.replacetags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.replacetags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacetags[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply replacetags to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.settags-Tuple{ITensors.AbstractMPS}" href="#ITensors.settags-Tuple{ITensors.AbstractMPS}"><code>ITensors.settags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">settags[!](M::MPS, args...; kwargs...)
settags[!](M::MPO, args...; kwargs...)</code></pre><p>Apply settags to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.settags-Tuple{typeof(siteinds), ITensors.AbstractMPS}" href="#ITensors.settags-Tuple{typeof(siteinds), ITensors.AbstractMPS}"><code>ITensors.settags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">settags[!](siteinds, M::MPS, args...; kwargs...)
settags[!](siteinds, M::MPO, args...; kwargs...)</code></pre><p>Apply settags to all site indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L719-L726">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.settags-Tuple{typeof(linkinds), ITensors.AbstractMPS}" href="#ITensors.settags-Tuple{typeof(linkinds), ITensors.AbstractMPS}"><code>ITensors.settags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">settags[!](linkinds, M::MPS, args...; kwargs...)
settags[!](linkinds, M::MPO, args...; kwargs...)</code></pre><p>Apply settags to all link indices of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L703-L710">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.settags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.settags-Tuple{typeof(siteinds), typeof(commoninds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.settags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">settags[!](siteinds, commoninds, M1::MPO, M2::MPS, args...; kwargs...)
settags[!](siteinds, commoninds, M1::MPO, M2::MPO, args...; kwargs...)</code></pre><p>Apply settags to the site indices that are shared by <code>M1</code> and <code>M2</code>.</p><p>Returns new MPSs/MPOs. The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L735-L742">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.settags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}" href="#ITensors.settags-Tuple{typeof(siteinds), typeof(uniqueinds), ITensors.AbstractMPS, ITensors.AbstractMPS}"><code>ITensors.settags</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">settags[!](siteinds, uniqueinds, M1::MPO, M2::MPS, args...; kwargs...)</code></pre><p>Apply settags to the site indices of <code>M1</code> that are not shared with <code>M2</code>. Returns new MPSs/MPOs.</p><p>The ITensors of the MPSs/MPOs will be a view of the storage of the original ITensors.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L765-L771">source</a></section></article><h2 id="Operations-1"><a class="docs-heading-anchor" href="#Operations-1">Operations</a><a class="docs-heading-anchor-permalink" href="#Operations-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.expect-Tuple{MPS, Vararg{AbstractString, N} where N}" href="#ITensors.expect-Tuple{MPS, Vararg{AbstractString, N} where N}"><code>ITensors.expect</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">expect(psi::MPS,ops::AbstractString...;kwargs...)</code></pre><p>Given an MPS <code>psi</code> and an operator name, returns a vector of the expected value of the operator on  each site of the MPS. If multiple operator names are provided, returns a tuple of expectation value vectors.</p><p><strong>Optional Keyword Arguments</strong></p><ul><li><code>site_range = 1:length(psi)</code>: compute expected values only for sites in the given range</li></ul><p><strong>Examples</strong></p><pre><code class="language-julia">N = 10

s = siteinds(&quot;S=1/2&quot;,N)
psi = randomMPS(s,8)
Z = expect(psi,&quot;Sz&quot;;site_range=2:6)

s = siteinds(&quot;Electron&quot;,N)
psi = randomMPS(s,8)
dens = expect(psi,&quot;Ntot&quot;)
updens,dndens = expect(psi,&quot;Nup&quot;,&quot;Ndn&quot;)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L617-L642">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.correlation_matrix-Tuple{MPS, AbstractString, AbstractString}" href="#ITensors.correlation_matrix-Tuple{MPS, AbstractString, AbstractString}"><code>ITensors.correlation_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">correlation_matrix(psi::MPS,
                   Op1::AbstractString,
                   Op2::AbstractString;
                   kwargs...)</code></pre><p>Given an MPS psi and two strings denoting operators (as recognized by the <code>op</code> function),  computes the two-point correlation function matrix C[i,j] = &lt;psi| Op1i Op2j |psi&gt; using efficient MPS techniques. Returns the matrix C.</p><p><strong>Optional Keyword Arguments</strong></p><ul><li><code>site_range = 1:length(psi)</code>: compute correlations only for sites in the given range</li></ul><p>For a correlation matrix of size NxN and an MPS of typical bond dimension m, the scaling of this algorithm is N^2*m^3.</p><p><strong>Examples</strong></p><pre><code class="language-julia">N = 30
m = 4

s = siteinds(&quot;S=1/2&quot;,N)
psi = randomMPS(s,m)
Czz = correlator(psi,&quot;Sz&quot;,&quot;Sz&quot;)

s = siteinds(&quot;Electron&quot;,N; conserve_qns=true)
psi = randomMPS(s,n-&gt;isodd(n) ? &quot;Up&quot; : &quot;Dn&quot;,m)
Cuu = correlator(psi,&quot;Cdagup&quot;,&quot;Cup&quot;;site_range=2:8)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L515-L546">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.dag-Tuple{ITensors.AbstractMPS}" href="#ITensors.dag-Tuple{ITensors.AbstractMPS}"><code>ITensors.dag</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dag[!](M::MPS, args...; kwargs...)
dag[!](M::MPO, args...; kwargs...)</code></pre><p>Apply dag to all ITensors of an MPS/MPO, returning a new MPS/MPO.</p><p>The ITensors of the MPS/MPO will be a view of the storage of the original ITensors. Alternatively apply the function in-place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L567-L574">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.NDTensors.dense-Tuple{ITensors.AbstractMPS}" href="#ITensors.NDTensors.dense-Tuple{ITensors.AbstractMPS}"><code>ITensors.NDTensors.dense</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dense(::MPS/MPO)</code></pre><p>Given an MPS (or MPO), return a new MPS (or MPO)  having called <code>dense</code> on each ITensor to convert each tensor to use dense storage and remove any QN or other sparse structure information, if it is not dense already.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L306-L313">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.movesite-Tuple{ITensors.AbstractMPS, Pair{Int64, Int64}}" href="#ITensors.movesite-Tuple{ITensors.AbstractMPS, Pair{Int64, Int64}}"><code>ITensors.movesite</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">movesite(::Union{MPS, MPO}, n1n2::Pair{Int, Int})</code></pre><p>Create a new MPS/MPO where the site at <code>n1</code> is moved to <code>n2</code>, for a pair <code>n1n2 = n1 =&gt; n2</code>.</p><p>This is done with a series a pairwise swaps, and can introduce a lot of entanglement into your state, so use with caution.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1494-L1502">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.orthogonalize!" href="#ITensors.orthogonalize!"><code>ITensors.orthogonalize!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">orthogonalize!(M::MPS, j::Int; kwargs...)
orthogonalize(M::MPS, j::Int; kwargs...)

orthogonalize!(M::MPO, j::Int; kwargs...)
orthogonalize(M::MPO, j::Int; kwargs...)</code></pre><p>Move the orthogonality center of the MPS to site <code>j</code>. No observable property of the MPS will be changed, and no truncation of the bond indices is performed. Afterward, tensors <code>1,2,...,j-1</code> will be left-orthogonal and tensors <code>j+1,j+2,...,N</code> will be right-orthogonal.</p><p>Either modify in-place with <code>orthogonalize!</code> or out-of-place with <code>orthogonalize</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1127-L1143">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.replacebond!-Tuple{MPS, Int64, ITensor}" href="#ITensors.replacebond!-Tuple{MPS, Int64, ITensor}"><code>ITensors.replacebond!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">replacebond!(M::MPS, b::Int, phi::ITensor; kwargs...)</code></pre><p>Factorize the ITensor <code>phi</code> and replace the ITensors <code>b</code> and <code>b+1</code> of MPS <code>M</code> with the factors. Choose the orthogonality with <code>ortho=&quot;left&quot;/&quot;right&quot;</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L384-L390">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.sample-Tuple{MPS}" href="#ITensors.sample-Tuple{MPS}"><code>ITensors.sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">sample(m::MPS)</code></pre><p>Given a normalized MPS m with <code>orthocenter(m)==1</code>, returns a <code>Vector{Int}</code> of <code>length(m)</code> corresponding to one sample of the probability distribution defined by squaring the components of the tensor that the MPS represents</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L462-L471">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.sample!-Tuple{MPS}" href="#ITensors.sample!-Tuple{MPS}"><code>ITensors.sample!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">sample!(m::MPS)</code></pre><p>Given a normalized MPS m, returns a <code>Vector{Int}</code> of <code>length(m)</code> corresponding to one sample of the probability distribution defined by squaring the components of the tensor that the MPS represents. If the MPS does not have an orthogonality center, orthogonalize!(m,1) will be called before computing the sample.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mps.jl#L445-L456">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.sample-Tuple{MPO}" href="#ITensors.sample-Tuple{MPO}"><code>ITensors.sample</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">sample(M::MPO)</code></pre><p>Given a normalized MPO <code>M</code>, returns a <code>Vector{Int}</code> of <code>length(M)</code> corresponding to one sample of the probability distribution defined by the MPO, treating the MPO as a density matrix.</p><p>The MPO <code>M</code> should have an (approximately) positive spectrum.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L542-L553">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.swapbondsites-Tuple{ITensors.AbstractMPS, Int64}" href="#ITensors.swapbondsites-Tuple{ITensors.AbstractMPS, Int64}"><code>ITensors.swapbondsites</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">swapbondsites(ψ::Union{MPS, MPO}, b::Integer; kwargs...)</code></pre><p>Swap the sites <code>b</code> and <code>b+1</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1472-L1476">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.NDTensors.truncate!" href="#ITensors.NDTensors.truncate!"><code>ITensors.NDTensors.truncate!</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia">truncate!(M::MPS; kwargs...)
truncate!(M::MPO; kwargs...)</code></pre><p>Perform a truncation of all bonds of an MPS/MPO, using the truncation parameters (cutoff,maxdim, etc.) provided as keyword arguments.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1194-L1201">source</a></section></article><h2 id="Gate-evolution-1"><a class="docs-heading-anchor" href="#Gate-evolution-1">Gate evolution</a><a class="docs-heading-anchor-permalink" href="#Gate-evolution-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="ITensors.product-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:ITensor, ITensors.AbstractMPS}" href="#ITensors.product-Tuple{Vector{var&quot;#s58&quot;} where var&quot;#s58&quot;&lt;:ITensor, ITensors.AbstractMPS}"><code>ITensors.product</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">product(As::Vector{&lt;:ITensor}, M::Union{MPS, MPO}; &lt;keyword arguments&gt;)
apply([...])</code></pre><p>Apply the ITensors <code>As</code> to the MPS or MPO <code>M</code>, treating them as gates or matrices from pairs of prime or unprimed indices.</p><p><strong>Examples</strong></p><p>Apply one-site gates to an MPS:</p><pre><code class="language-julia">N = 3

ITensors.op(::OpName&quot;σx&quot;, ::SiteType&quot;S=1/2&quot;, s::Index) =
  2*op(&quot;Sx&quot;, s)

ITensors.op(::OpName&quot;σz&quot;, ::SiteType&quot;S=1/2&quot;, s::Index) =
  2*op(&quot;Sz&quot;, s)

# Make the operator list.
os = [(&quot;σx&quot;, n) for n in 1:N]
append!(os, [(&quot;σz&quot;, n) for n in 1:N])

@show os

s = siteinds(&quot;S=1/2&quot;, N)
gates = ops(os, s)

# Starting state |↑↑↑⟩
ψ0 = MPS(s, &quot;↑&quot;)

# Apply the gates.
ψ = apply(gates, ψ0; cutoff = 1e-15)

# Test against exact (full) wavefunction
prodψ = apply(gates, prod(ψ0))
@show prod(ψ) ≈ prodψ

# The result is:
# σz₃ σz₂ σz₁ σx₃ σx₂ σx₁ |↑↑↑⟩ = -|↓↓↓⟩
@show inner(ψ, MPS(s, &quot;↓&quot;)) == -1</code></pre><p>Apply nonlocal two-site gates and one-site gates to an MPS:</p><pre><code class="language-julia"># 2-site gate
function ITensors.op(::OpName&quot;CX&quot;, ::SiteType&quot;S=1/2&quot;, s1::Index, s2::Index)
  mat = [1 0 0 0
         0 1 0 0
         0 0 0 1
         0 0 1 0]
  return itensor(mat, s2&#39;, s1&#39;, s2, s1)
end

os = [(&quot;CX&quot;, 1, 3), (&quot;σz&quot;, 3)]

@show os

# Start with the state |↓↑↑⟩
ψ0 = MPS(s, n -&gt; n == 1 ? &quot;↓&quot; : &quot;↑&quot;)

# The result is:
# σz₃ CX₁₃ |↓↑↑⟩ = -|↓↑↓⟩
ψ = apply(ops(os, s), ψ0; cutoff = 1e-15)
@show inner(ψ, MPS(s, n -&gt; n == 1 || n == 3 ? &quot;↓&quot; : &quot;↑&quot;)) == -1</code></pre><p>Perform TEBD-like time evolution:</p><pre><code class="language-julia"># Define the nearest neighbor term `S⋅S` for the Heisenberg model
function ITensors.op(::OpName&quot;expS⋅S&quot;, ::SiteType&quot;S=1/2&quot;,
                     s1::Index, s2::Index; τ::Number)
  O = 0.5 * op(&quot;S+&quot;, s1) * op(&quot;S-&quot;, s2) +
      0.5 * op(&quot;S-&quot;, s1) * op(&quot;S+&quot;, s2) +
            op(&quot;Sz&quot;, s1) * op(&quot;Sz&quot;, s2)
  return exp(τ * O)
end

τ = -0.1im
os = [(&quot;expS⋅S&quot;, (1, 2), (τ = τ,)),
      (&quot;expS⋅S&quot;, (2, 3), (τ = τ,))]
ψ0 = MPS(s, n -&gt; n == 1 ? &quot;↓&quot; : &quot;↑&quot;)
expτH = ops(os, s)
ψτ = apply(expτH, ψ0)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L1636-L1718">source</a></section></article><h2 id="Algebra-Operations-1"><a class="docs-heading-anchor" href="#Algebra-Operations-1">Algebra Operations</a><a class="docs-heading-anchor-permalink" href="#Algebra-Operations-1" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.dot-Union{Tuple{MPST}, Tuple{MPST, MPST}} where MPST&lt;:ITensors.AbstractMPS" href="#LinearAlgebra.dot-Union{Tuple{MPST}, Tuple{MPST, MPST}} where MPST&lt;:ITensors.AbstractMPS"><code>LinearAlgebra.dot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">dot(A::MPS, B::MPS; make_inds_match = true)
inner(A::MPS, B::MPS; make_inds_match = true)

dot(A::MPO, B::MPO)
inner(A::MPO, B::MPO)</code></pre><p>Compute the inner product <code>&lt;A|B&gt;</code>. If <code>A</code> and <code>B</code> are MPOs, computes the Frobenius inner product.</p><p>If <code>make_inds_match = true</code>, the function attempts to make the site indices match before contracting (so for example, the inputs can have different site indices, as long as they have the same dimensions or QN blocks).</p><p>For now, <code>make_inds_match</code> is only supported for MPSs.</p><p>See also <code>logdot</code>/<code>loginner</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L888-L905">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.logdot-Union{Tuple{MPST}, Tuple{MPST, MPST}} where MPST&lt;:ITensors.AbstractMPS" href="#ITensors.logdot-Union{Tuple{MPST}, Tuple{MPST, MPST}} where MPST&lt;:ITensors.AbstractMPS"><code>ITensors.logdot</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">logdot(A::MPS, B::MPS; make_inds_match = true)
loginner(A::MPS, B::MPS; make_inds_match = true)

logdot(A::MPO, B::MPO)
loginner(A::MPO, B::MPO)</code></pre><p>Compute the logarithm of the inner product <code>&lt;A|B&gt;</code>. If <code>A</code> and <code>B</code> are MPOs, computes the logarithm of the Frobenius inner product.</p><p>This is useful for larger MPS/MPO, where in the limit of large numbers of sites the inner product can diverge or approach zero.</p><p>If <code>make_inds_match = true</code>, the function attempts to make the site indices match before contracting (so for example, the inputs can have different site indices, as long as they have the same dimensions or QN blocks).</p><p>For now, <code>make_inds_match</code> is only supported for MPSs.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L910-L927">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="LinearAlgebra.norm-Tuple{ITensors.AbstractMPS}" href="#LinearAlgebra.norm-Tuple{ITensors.AbstractMPS}"><code>LinearAlgebra.norm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">norm(A::MPS)
norm(A::MPO)</code></pre><p>Compute the norm of the MPS or MPO.</p><p>See also <code>lognorm</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L938-L945">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="ITensors.lognorm-Tuple{ITensors.AbstractMPS}" href="#ITensors.lognorm-Tuple{ITensors.AbstractMPS}"><code>ITensors.lognorm</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">lognorm(A::MPS)
lognorm(A::MPO)</code></pre><p>Compute the logarithm of the norm of the MPS or MPO. </p><p>This is useful for larger MPS/MPO that are not gauged, where in the limit of large numbers of sites the norm can diverge or approach zero.</p><p>See also <code>norm</code> and <code>loginner</code>/<code>logdot</code>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L948-L957">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:+-Tuple{MPS, MPS}" href="#Base.:+-Tuple{MPS, MPS}"><code>Base.:+</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">+(A::MPS/MPO...; kwargs...)
add(A::MPS/MPO...; kwargs...)</code></pre><p>Add arbitrary numbers of MPS/MPO with each other, with some optional truncation.</p><p>A cutoff of 1e-15 is used by default, and in general users should set their own cutoff for their particular application.</p><p>In the future we will give an interface for returning the truncation error.</p><p><strong>Examples</strong></p><pre><code class="language-julia">N = 10

s = siteinds(&quot;S=1/2&quot;, N; conserve_qns = true)

state = n -&gt; isodd(n) ? &quot;↑&quot; : &quot;↓&quot;
ψ₁ = randomMPS(s, state, 2)
ψ₂ = randomMPS(s, state, 2)
ψ₃ = randomMPS(s, state, 2)

ψ = +(ψ₁, ψ₂; cutoff = 1e-8)

# Can use:
#
# ψ = ψ₁ + ψ₂
#
# but generally you want to set a custom `cutoff` and `maxdim`.

println()
@show inner(ψ, ψ)
@show inner(ψ₁, ψ₂) + inner(ψ₁, ψ₂) + inner(ψ₂, ψ₁) + inner(ψ₂, ψ₂)

# Computes ψ₁ + 2ψ₂
ψ = ψ₁ + 2ψ₂

println()
@show inner(ψ, ψ)
@show inner(ψ₁, ψ₁) + 2 * inner(ψ₁, ψ₂) + 2 * inner(ψ₂, ψ₁) + 4 * inner(ψ₂, ψ₂)

# Computes ψ₁ + 2ψ₂ + ψ₃
ψ = ψ₁ + 2ψ₂ + ψ₃

println()
@show inner(ψ, ψ)
@show inner(ψ₁, ψ₁) + 2 * inner(ψ₁, ψ₂) + inner(ψ₁, ψ₃) +
      2 * inner(ψ₂, ψ₁) + 4 * inner(ψ₂, ψ₂) + 2 * inner(ψ₂, ψ₃) +
      inner(ψ₃, ψ₁) + 2 * inner(ψ₃, ψ₂) + inner(ψ₃, ψ₃)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/abstractmps.jl#L993-L1044">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="Base.:*-Tuple{MPO, MPS}" href="#Base.:*-Tuple{MPO, MPS}"><code>Base.:*</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia">contract(::MPS, ::MPO; kwargs...)
*(::MPS, ::MPO; kwargs...)

contract(::MPO, ::MPS; kwargs...)
*(::MPO, ::MPS; kwargs...)</code></pre><p>Contract the MPO with the MPS, returning an MPS with the unique site indices of the MPO.</p><p>Choose the method with the <code>method</code> keyword, for example &quot;densitymatrix&quot; and &quot;naive&quot;.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/ITensor/ITensors.jl/blob/e58ad8c30a655fd0ac66df609f034f4d893ea986/src/mps/mpo.jl#L353-L365">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="ITensorType.html">« ITensor</a><a class="docs-footer-nextpage" href="QN.html">QN »</a></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Friday 14 May 2021 15:18">Friday 14 May 2021</span>. Using Julia version 1.6.1.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
