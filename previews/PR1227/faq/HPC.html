<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>High-Performance Computing FAQs · ITensors.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script><link href="../assets/favicon.ico" rel="icon" type="image/x-icon"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../index.html"><img src="../assets/logo.png" alt="ITensors.jl logo"/></a><div class="docs-package-name"><span class="docs-autofit"><a href="../index.html">ITensors.jl</a></span></div><form class="docs-search" action="../search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../index.html">Introduction</a></li><li><span class="tocitem">Getting Started with ITensor</span><ul><li><a class="tocitem" href="../getting_started/Installing.html">Installing Julia and ITensor</a></li><li><a class="tocitem" href="../getting_started/RunningCodes.html">Running ITensor and Julia Codes</a></li><li><a class="tocitem" href="../getting_started/DebugChecks.html">Enabling Debug Checks</a></li><li><a class="tocitem" href="../getting_started/NextSteps.html">Next Steps</a></li></ul></li><li><span class="tocitem">Tutorials</span><ul><li><a class="tocitem" href="../tutorials/DMRG.html">DMRG</a></li><li><a class="tocitem" href="../tutorials/QN_DMRG.html">Quantum Number Conserving DMRG</a></li><li><a class="tocitem" href="../tutorials/MPSTimeEvolution.html">MPS Time Evolution</a></li></ul></li><li><span class="tocitem">Code Examples</span><ul><li><a class="tocitem" href="../examples/ITensor.html">ITensor Examples</a></li><li><a class="tocitem" href="../examples/MPSandMPO.html">MPS and MPO Examples</a></li><li><a class="tocitem" href="../examples/DMRG.html">DMRG Examples</a></li><li><a class="tocitem" href="../examples/Physics.html">Physics (SiteType) System Examples</a></li></ul></li><li><span class="tocitem">Documentation</span><ul><li><a class="tocitem" href="../IndexType.html">Index</a></li><li><a class="tocitem" href="../IndexSetType.html">Index collections</a></li><li><a class="tocitem" href="../ITensorType.html">ITensor</a></li><li><a class="tocitem" href="../MPSandMPO.html">MPS and MPO</a></li><li><a class="tocitem" href="../QN.html">QN</a></li><li><a class="tocitem" href="../SiteType.html">SiteType and op, state, val functions</a></li><li><a class="tocitem" href="../IncludedSiteTypes.html">SiteTypes Included with ITensor</a></li><li><input class="collapse-toggle" id="menuitem-5-8" type="checkbox"/><label class="tocitem" for="menuitem-5-8"><span class="docs-label">DMRG</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../DMRG.html">DMRG</a></li><li><a class="tocitem" href="../Sweeps.html">Sweeps</a></li><li><a class="tocitem" href="../ProjMPO.html">ProjMPO</a></li><li><a class="tocitem" href="../ProjMPOSum.html">ProjMPOSum</a></li><li><a class="tocitem" href="../Observer.html">Observer System for DMRG</a></li><li><a class="tocitem" href="../DMRGObserver.html">DMRGObserver</a></li></ul></li><li><a class="tocitem" href="../OpSum.html">OpSum (AutoMPO)</a></li></ul></li><li><span class="tocitem">Frequently Asked Questions</span><ul><li><a class="tocitem" href="JuliaAndCpp.html">Programming Language (Julia, C++, ...) FAQs</a></li><li><a class="tocitem" href="DMRG.html">DMRG FAQs</a></li><li><a class="tocitem" href="QN.html">Quantum Number (QN) FAQs</a></li><li><a class="tocitem" href="Development.html">ITensor Development FAQs</a></li><li><a class="tocitem" href="RelationshipToOtherLibraries.html">Relationship of ITensor to other tensor libraries FAQs</a></li><li><a class="tocitem" href="JuliaPkg.html">Julia Package Manager FAQs</a></li><li class="is-active"><a class="tocitem" href="HPC.html">High-Performance Computing FAQs</a><ul class="internal"><li><a class="tocitem" href="#My-code-is-using-a-lot-of-RAM-what-can-I-do-about-this?"><span>My code is using a lot of RAM - what can I do about this?</span></a></li><li><a class="tocitem" href="#Can-Julia-Be-Used-to-Perform-Parallel,-Distributed-Calculations-on-Large-Clusters?"><span>Can Julia Be Used to Perform Parallel, Distributed Calculations on Large Clusters?</span></a></li><li><a class="tocitem" href="#Does-My-Cluster-Admin-Have-to-Install-Julia-for-Me?-What-are-the-Best-Practices-for-Installing-Julia-on-Clusters?"><span>Does My Cluster Admin Have to Install Julia for Me? What are the Best Practices for Installing Julia on Clusters?</span></a></li></ul></li></ul></li><li><span class="tocitem">Upgrade guides</span><ul><li><a class="tocitem" href="../UpgradeGuide_0.1_to_0.2.html">Upgrading from 0.1 to 0.2</a></li></ul></li><li><a class="tocitem" href="../Einsum.html">ITensor indices and Einstein notation</a></li><li><span class="tocitem">Advanced Usage Guide</span><ul><li><a class="tocitem" href="../AdvancedUsageGuide.html">Advanced Usage Guide</a></li><li><a class="tocitem" href="../Multithreading.html">Multithreading</a></li><li><a class="tocitem" href="../QNTricks.html">Symmetric (QN conserving) tensors: background and usage</a></li><li><a class="tocitem" href="../CodeTiming.html">Timing and profiling</a></li><li><a class="tocitem" href="../ContractionSequenceOptimization.html">Contraction sequence optimization</a></li><li><a class="tocitem" href="../HDF5FileFormats.html">HDF5 File Formats</a></li></ul></li><li><a class="tocitem" href="../DeveloperGuide.html">Developer Guide</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Frequently Asked Questions</a></li><li class="is-active"><a href="HPC.html">High-Performance Computing FAQs</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="HPC.html">High-Performance Computing FAQs</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ITensor/ITensors.jl/blob/main/docs/src/faq/HPC.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="High-Performance-Computing-(HPC)-Frequently-Asked-Questions"><a class="docs-heading-anchor" href="#High-Performance-Computing-(HPC)-Frequently-Asked-Questions">High Performance Computing (HPC) Frequently Asked Questions</a><a id="High-Performance-Computing-(HPC)-Frequently-Asked-Questions-1"></a><a class="docs-heading-anchor-permalink" href="#High-Performance-Computing-(HPC)-Frequently-Asked-Questions" title="Permalink"></a></h1><h2 id="My-code-is-using-a-lot-of-RAM-what-can-I-do-about-this?"><a class="docs-heading-anchor" href="#My-code-is-using-a-lot-of-RAM-what-can-I-do-about-this?">My code is using a lot of RAM - what can I do about this?</a><a id="My-code-is-using-a-lot-of-RAM-what-can-I-do-about-this?-1"></a><a class="docs-heading-anchor-permalink" href="#My-code-is-using-a-lot-of-RAM-what-can-I-do-about-this?" title="Permalink"></a></h2><p>Tensor network algorithms can often use a large amount of RAM. On top of this essential fact, the Julia programming languge is &quot;garbage collected&quot; which means that unused memory isn&#39;t given back to the operating system right away,  but only when the Julia runtime dynamically reclaims it. When your code allocates memory very rapidly, this can lead to high memory usage overall.</p><p>Fortunately there are various steps you can take to keep the memory usage of your code under control.</p><h3 id=".-Avoid-Repeatedly-Allocating,-Especially-in-Fast-or-&quot;Hot&quot;-Loops"><a class="docs-heading-anchor" href="#.-Avoid-Repeatedly-Allocating,-Especially-in-Fast-or-&quot;Hot&quot;-Loops">1. Avoid Repeatedly Allocating, Especially in Fast or &quot;Hot&quot; Loops</a><a id=".-Avoid-Repeatedly-Allocating,-Especially-in-Fast-or-&quot;Hot&quot;-Loops-1"></a><a class="docs-heading-anchor-permalink" href="#.-Avoid-Repeatedly-Allocating,-Especially-in-Fast-or-&quot;Hot&quot;-Loops" title="Permalink"></a></h3><p>More memory gets used whenever your code &quot;allocates&quot;, which happens most commonly when you use dynamic storage types like <code>Vector</code> and <code>Matrix</code>. If you have a code pattern where you allocate or resize an array or vector inside a &#39;hot&#39; loop,  meaning a loop that iterates quickly very many times, the memory from the previous  allocations may pile up very quickly before the next garbage collector run. </p><p>To avoid this, allocate the array once before the loop begins if possible, then overwrite its contents during each iteration. More generally, try as much as possible to estimate the sizes of dynamic resources ahead of time. Or do one allocation that creates a large enough &quot;workspace&quot; that dynamic algorithms can reuse part of without reallocating the whole workspace (i.e. making a large array once then using portions of it when smaller arrays are needed).</p><h3 id=".-Use-the-heap-size-hint-Flag"><a class="docs-heading-anchor" href="#.-Use-the-heap-size-hint-Flag">2. Use the <code>--heap-size-hint</code> Flag</a><a id=".-Use-the-heap-size-hint-Flag-1"></a><a class="docs-heading-anchor-permalink" href="#.-Use-the-heap-size-hint-Flag" title="Permalink"></a></h3><p>A simple step you can take to help with overall memory usage is to pass the <code>--heap-size-hint</code> flag to the Julia program when you start it. For example, you can call Julia as:</p><pre><code class="nohighlight hljs">julia --heap-size-hint=60G</code></pre><p>When you pass this heap size, Julia will try to keep the memory usage at or below this value if possible.</p><p>In cases where this does not work, your code simply may be allocating too much memory. Be sure not to allocate over and over again inside of &quot;hot&quot; loops which execute many times.</p><p>Another possibility is that you are simply working with a tensor network with large  bond dimensions, which may fundamentally use a lot of memory. In those cases, you can  try to use features such as &quot;write to disk mode&quot; of the ITensor DMRG code or other related techniques. (See the <code>write_when_maxdim_exceeds</code> keyword of the ITensor <code>dmrg</code> function.)</p><h3 id=".-In-Rare-Case,-Force-a-Garbage-Collection-Run"><a class="docs-heading-anchor" href="#.-In-Rare-Case,-Force-a-Garbage-Collection-Run">3. In Rare Case, Force a Garbage Collection Run</a><a id=".-In-Rare-Case,-Force-a-Garbage-Collection-Run-1"></a><a class="docs-heading-anchor-permalink" href="#.-In-Rare-Case,-Force-a-Garbage-Collection-Run" title="Permalink"></a></h3><p>In some rare cases, such as when your code cannot be optimized to avoid any more allocations or when the <code>--heap-size-hint</code> provided above is not affecting the behavior of the Julia garbage collector, you can force the garbage collector (GC) to run at a specific point in your code by calling:</p><pre><code class="nohighlight hljs">GC.gc()</code></pre><p>Alternatively, you can call <code>GC.gc(true)</code> to force a &quot;full run&quot; rather than just collecting a more &#39;young&#39; subset of previous allocations.</p><p>While this approach works well to reduce memory usage, it can have the unfortunate downside of slowing down your code each time the garbage collector runs, which can be especially harmful to multithreaded or parallel algorithms. Therefore, if this approach must be used try calling <code>GC.gc()</code> as infrequently as possible and ideally only in the outermost functions and loops of your code (highest levels of your code).</p><h2 id="Can-Julia-Be-Used-to-Perform-Parallel,-Distributed-Calculations-on-Large-Clusters?"><a class="docs-heading-anchor" href="#Can-Julia-Be-Used-to-Perform-Parallel,-Distributed-Calculations-on-Large-Clusters?">Can Julia Be Used to Perform Parallel, Distributed Calculations on Large Clusters?</a><a id="Can-Julia-Be-Used-to-Perform-Parallel,-Distributed-Calculations-on-Large-Clusters?-1"></a><a class="docs-heading-anchor-permalink" href="#Can-Julia-Be-Used-to-Perform-Parallel,-Distributed-Calculations-on-Large-Clusters?" title="Permalink"></a></h2><p>Yes. The Julia ecosystem offers multiple approaches to parallel computing across multiple machines including on large HPC clusters and including GPU resources. </p><p>For an overall view of some of these options, the <a href="https://juliahpc.github.io/JuliaOnHPCClusters/">Julia on HPC Clusters</a> website is a good resource.</p><p>Some of the leading approaches to parallelism in Julia are:</p><ul><li>MPI, through the <a href="https://juliaparallel.org/MPI.jl/latest/">MPI.jl</a> package. Has the advantage of optionally using an MPI backend that is optimized for a particular cluster and possibly using fast interconnects like Infiniband.</li><li><a href="https://juliaparallel.org/Dagger.jl/dev/">Dagger</a>, a framework for parallel computing across all kinds of resources, like CPUs and GPUs, and across multiple threads and multiple servers.</li><li><a href="https://docs.julialang.org/en/v1/stdlib/Distributed/">Distributed</a>. Part of the base Julia library, giving tools to perform calculations distributed across multiple machines.</li></ul><h2 id="Does-My-Cluster-Admin-Have-to-Install-Julia-for-Me?-What-are-the-Best-Practices-for-Installing-Julia-on-Clusters?"><a class="docs-heading-anchor" href="#Does-My-Cluster-Admin-Have-to-Install-Julia-for-Me?-What-are-the-Best-Practices-for-Installing-Julia-on-Clusters?">Does My Cluster Admin Have to Install Julia for Me? What are the Best Practices for Installing Julia on Clusters?</a><a id="Does-My-Cluster-Admin-Have-to-Install-Julia-for-Me?-What-are-the-Best-Practices-for-Installing-Julia-on-Clusters?-1"></a><a class="docs-heading-anchor-permalink" href="#Does-My-Cluster-Admin-Have-to-Install-Julia-for-Me?-What-are-the-Best-Practices-for-Installing-Julia-on-Clusters?" title="Permalink"></a></h2><p>The most common approach to installing and using Julia on clusters is for users to install their own Julia binary and dependencies, which is quite easy to do. However, for certain libraries like MPI.jl, there may be MPI backends that are preferred by the cluster administrator. Fortunately, it is possible for admins to set global defaults for such backends and other library preferences.</p><p>For more information on best practices for installing Julia on clusters, see the <a href="https://juliahpc.github.io/JuliaOnHPCClusters/">Julia on HPC Clusters</a> website.</p></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="JuliaPkg.html">« Julia Package Manager FAQs</a><a class="docs-footer-nextpage" href="../UpgradeGuide_0.1_to_0.2.html">Upgrading from 0.1 to 0.2 »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.25 on <span class="colophon-date" title="Thursday 2 November 2023 22:21">Thursday 2 November 2023</span>. Using Julia version 1.9.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
